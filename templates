<!DOCTYPE html>
<html class="no-js" lang="en">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

{% include 'include/header.html' %}




<script src="/static/assets/editor/editor.js"></script>



<link href="/static/assets/editor/editor.css" type="text/css" rel="stylesheet" />

<body>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->
  {% include 'include/headersidebar.html' %}

  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title">Key upload</h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="yoo-card yoo-style1">
            <div class="yoo-card-heading">
              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Thông tin tài khoản</h2>
              </div>
            </div>
            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <form>
                  <div class="form-group level-up active2">
                    <label for="exampleInputEmail18">API KEY</label>
                    <input type="email" class="form-control" id="txtapikey" aria-describedby="emailHelp">
                    <small id="emailHelp" class="form-text text-muted"></small>
                  </div>
                  <div class="form-group level-up active2">
                    <label for="exampleInputEmail18">PASSWORD</label>
                    <input type="email" class="form-control" id="txtpassword" aria-describedby="emailHelp">
                    <small id="emailHelp" class="form-text text-muted"></small>
                  </div>


                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-lg"
                    onclick="save(event)">LƯU</button>
                  <br>
                  <br>
                </form>

              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->
      {% include 'include/footer.html' %}

    </div>
    <!-- .yoo-content -->
    <script>
      document.querySelector(".yoo-uikits-title").textContent = "Quản lý tài khoản";
      GetAllApp()

      function GetAllApp() {
        $.ajax({
          url: "/accountinfo",
          type: "get",
          dataType: "text",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          success: function (results) {
            const obj = JSON.parse(results);
            $("#txtapikey").val(obj.apikey);

          }
        });
      }



      function save() {
        var person = {
          apikey: $("#txtapikey").val(),
          password: $("#txtpassword").val(),
        }
        $.ajax({
          url: "/accountedit",
          type: "post",
          dataType: "json",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          data: JSON.stringify(person),
          contentType: 'application/json',
          success: function (result) {


            var msg = result.mess;

            if (msg == "success") {
              toastr.success("Cập nhật thành công");
              // window.location.href = "/accountmanager.html";

            } else {
              toastr.error(msg);

            }
            // const obj = JSON.parse(result);
            // var result = obj.result;
            // var stringToRender = ""

            // for (let i = 0; i < result.length; i++) {
            //   const onePost = result[i];
            //   stringToRender += `${onePost.keyactive}\n`
            // }
            // $("#output").val(stringToRender);
            // CopyTextareaToClipboard('output')
          }
        });
      }

    </script>

    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

{% include 'include/header.html' %}
<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
  }

  * {
    box-sizing: border-box;
  }

  body input {
    border: none;
  }

  body input:focus {
    outline: none;
  }




  /* Set a style for all buttons */
  button {
    background-color: #04AA6D;
    color: white;
    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    cursor: pointer;
    width: 100%;
    opacity: 0.9;
  }

  button:hover {
    opacity: 1;
  }

  /* Float cancel and delete buttons and add an equal width */
  .cancelbtn,
  .deletebtn {
    float: left;
    width: 50%;
  }

  /* Add a color to the cancel button */
  .cancelbtn {
    background-color: #ccc;
    color: black;
  }

  /* Add a color to the delete button */
  .deletebtn {
    background-color: #f44336;
  }

  /* Add padding and center-align text to the container */
  .container {
    padding: 16px;
    text-align: center;
  }

  /* The Modal (background) */
  .modal {
    display: none;
    /* Hidden by default */
    position: fixed;
    /* Stay in place */
    z-index: 1;
    /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    /* Full width */
    height: 100%;
    /* Full height */
    overflow: auto;
    /* Enable scroll if needed */
    background-color: #474e5d;
    padding-top: 50px;
  }

  /* Modal Content/Box */
  .modal-content {
    background-color: #fefefe;
    margin: 5% auto 15% auto;
    /* 5% from the top, 15% from the bottom and centered */
    border: 1px solid #888;
    width: 80%;
    /* Could be more or less, depending on screen size */
  }

  /* Style the horizontal ruler */
  hr {
    border: 1px solid #f1f1f1;
    margin-bottom: 25px;
  }

  /* The Modal Close Button (x) */
  .close {
    position: absolute;
    right: 35px;
    top: 15px;
    font-size: 40px;
    font-weight: bold;
    color: #f1f1f1;
  }

  .close:hover,
  .close:focus {
    color: #f44336;
    cursor: pointer;
  }

  /* Clear floats */
  .clearfix::after {
    content: "";
    clear: both;
    display: table;
  }

  /* Change styles for cancel button and delete button on extra small screens */
  @media screen and (max-width: 300px) {

    .cancelbtn,
    .deletebtn {
      width: 100%;
    }
  }

  .display_heading {
    display: flex;
    justify-content: space-between;
  }

  ._1MmTVs {
    padding: 12px 0;
    margin: 5px 0;
    display: flex;
    align-items: center;
    box-shadow: 0 1px 1px 0 rgb(0 0 0 / 5%);
    color: #212121;
    background: #eaeaea;
    /* border-radius: 10px 10px 0 10px; */
    border-radius: 10px;
  }

  .imagePrd {
    border: 1px solid lightgray;
    margin-left: 5px;
    margin-right: 10px;
  }

  ._1MmTVs>input {
    flex: 1;
    font-size: 14px;
    line-height: 16px;
    border: 0;
    outline: none;
    background-color: inherit;
  }

  ._1MmTVs>svg {
    margin: 0 15px;
    stroke: #bbb;
  }
</style>

<body>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->
  {% include 'include/headersidebar.html' %}

  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title">Check mail</h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="yoo-card yoo-style1">
            <div class="yoo-card-heading">
              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Nhập mail</h2>
              </div>

            </div>
            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <form>
                  <div class="form-group level-up">
                    <label for="exampleFormControlTextarea1"></label>
                    <textarea class="form-control" style="max-height: none;" id="input" rows="15"
                      placeholder="Nhập mỗi email 1 dòng. Định dạng: email|..."></textarea>
                  </div>
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-lg"
                    onclick="check(event)">Check now</button>
                  <br>
                  <br>
                </form>
                <div class="yoo-height-b5 yoo-height-lg-b5"></div>
              </div>
            </div>



          </div>
        </div>

      </div>
      <br>
      <div class="row">
        <div class="col-lg-12">

          <div class="yoo-card yoo-style1">

            <div class="yoo-card-heading">

              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Output</h2>
              </div>
              <b><span class="" id="liveverify" style="color:blue; margin-top : 20px ; padding:0 ;"></span></b>


            </div>
            <!-- <div class="col-md-2">

              </div>
              <div class="col-md-2">

              </div> -->




            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th scope="col" width="2%">#</th>
                      <th scope="col" width="10%">email</th>
                      <th scope="col" width="15%">password</th>
                      <th scope="col" width="15%">emailrecovery</th>
                      <th scope="col" width="5%">status</th>
                      <th scope="col" width="5%">birthday</th>
                      <th scope="col" width="5%">phonerecovery</th>
                      <th scope="col" width="5%">groups</th>
                      <th scope="col" width="10%">datecreate</th>
                      <th scope="col" width="5%">updater</th>
                      <th scope="col" width="15%">proxy</th>
                      <th scope="col" width="5%">proxylist</th>
                      <th scope="col" width="15%">#</th>
                    </tr>
                  </thead>
                  <tbody id="files"></tbody>
                </table>

                <div id="page" style="display:flex ; justify-content: center;"></div>


              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>


      {% include 'include/footer.html' %}
      <!-- .yoo-card -->

    </div>
    <!-- .yoo-content -->
    <script>

      // Get the modal




      function Loadmail(page) {
        var date = $("#combongaytaomail").val()
        var status = $("#combostatus").val()
        var device = $("#combodevice").val()
        var search = window.location.search;
        // var page = "1";
        // var pages = Regex(search, /page=(\d+)/)
        // if (pages != null && pages.length > 1) {
        //   page = pages[1]
        // }
        $.ajax({
          url: "/loadmail?page=" + page + "&datecreate=" + date + "&status=" + status + "&device=" + device,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var max = obj.max;
            var count = obj.count
            var pagedu = count % max
            if (pagedu != 0) {
              pagedu = 1
            }
            var countpage = count / max + pagedu
            var result = obj.result;
            var stringToRender = ""
            var paginations = `<ul class="pagination pagination-lg">`

            var pageshow = pagination(page, countpage)


            for (let i = 0; i < pageshow.length; i++) {
              var pageht = pageshow[i]
              if (pageht == page || pageht == "...") {
                paginations = paginations +
                  `<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1">${pageht}</a></li>`
              } else {
                paginations = paginations +
                  // `<li class="page-item"><a class="page-link" href="${window.location.pathname}?page=${pageht}">${pageht}</a></li>`
                  `<li class="page-item"><a class="page-link" style="color:blue" onclick="Loadmail(${pageht})">${pageht}</a></li>`
              }
            }
            paginations = paginations + `</ul>`
            let verify = 0;
            let x = 0;
            for (let i = 0; i < result.length; i++) {
              x = x + 1
              const onePost = result[i];
              if (Contains(onePost.status, "Verify") == true || Contains(onePost.status, "Disable") == true) {
                verify = verify + 1;
              }
              //  console.log(onePost)
              stringToRender +=
                `<tr id="${onePost.id}"><td>${i + 1}</td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.email}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.password}"></td><td><input type="text" style="width:100%;" value="${onePost.emailrecovery}"></td><td><input type="text" value="${onePost.status}"></td><td><input type="text" value="${onePost.birthday}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.phonerecovery}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.groups}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.datecreate}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.updater}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxy}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxylist}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
            }
            let tileveri = Math.ceil(verify / x * 100)
            let tilelive = 100 - tileveri
            $("#files").html(stringToRender);
            $("#page").html(paginations);
            $("#countmail").html("" + count + "");
            $("#liveverify").html("<span>&#9758;	</span>Verify: " + verify + " (" + tileveri + "%) <span>&#10159;</span> Live: " + (x - verify) + " (" + tilelive + "%)");
            $('input[value="undefined"]').val("");
            $('tr > *:nth-child(6)').hide();
            $('tr > *:nth-child(7)').hide();
            // $('tr > *:nth-child(10)').hide();
            $('tr > *:nth-child(12)').hide();
          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }

      function Del(id) {
        var r = confirm("Xác nhận xóa!");
        if (r !== true) {
          return
        }
        $.ajax({
          url: "/maildelete/" + id,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var result = obj.mess;
            if (result == "success") {
              toastr.success("Xóa thành công");
              document.getElementById(id).remove();
            } else {
              toastr.success(result);
            }
          }
        });
      }
      var varcheck = null;
      function check() {
        var person = {
          listmail: $('#input').val()
        }
        $.ajax({
          url: "checkmail",
          type: "post",
          dataType: "json",
          data: JSON.stringify(person),
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          contentType: 'application/json',
          success: function (obj) {
            // const obj = JSON.parse(results);
            var id = obj.id;
            if (id == undefined) {
              toastr.error(obj.mess);
              return;
            }
            varcheck = setInterval(() => getmailcheck(id), 1000);
          }
        });
      }
      function getmailcheck(id) {
        $.ajax({
          url: "getmailcheck?id=" + id,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          contentType: 'application/json',
          success: function (obj) {
            var msg = obj.mess;
            if (msg == undefined) {
              msg = ""
            }
            // console.log("111111111" + "_" + msg)
            if (msg != "") {
              toastr.warning(msg);
              if (msg === "Id không tồn tại") {
                clearInterval(varcheck)
              }
            } else {
              toastr.success("Check mail xong")
              clearInterval(varcheck)
              var max = obj.max;
              var count = obj.count
              var pagedu = count % max
              if (pagedu != 0) {
                pagedu = 1
              }
              var countpage = count / max + pagedu
              var result = obj.result;
              var stringToRender = ""

              let verify = 0;
              let x = 0;
              for (let i = 0; i < result.length; i++) {
                x = x + 1
                const onePost = result[i];
                if (Contains(onePost.status, "Verify") == true || Contains(onePost.status, "Disable") == true) {
                  verify = verify + 1;
                }
                //  console.log(onePost)
                stringToRender +=
                  `<tr id="${onePost.id}"><td>${i + 1}</td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.email}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.password}"></td><td><input type="text" style="width:100%;" value="${onePost.emailrecovery}"></td><td><input type="text" value="${onePost.status}"></td><td><input type="text" value="${onePost.birthday}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.phonerecovery}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.groups}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.datecreate}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.updater}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxy}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxylist}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
              }
              let tileveri = Math.ceil(verify / x * 100)
              let tilelive = 100 - tileveri
              $("#files").html(stringToRender);

              $("#liveverify").html("<span>&#9758;	</span>Verify: " + verify + " (" + tileveri + "%) <span>&#10159;</span> Live: " + (x - verify) + " (" + tilelive + "%)");
              $('input[value="undefined"]').val("");
              $('tr > *:nth-child(6)').hide();
              $('tr > *:nth-child(7)').hide();
              // $('tr > *:nth-child(10)').hide();
              $('tr > *:nth-child(12)').hide();

            }
          }
        });
      }
      function Update(id) {
        var r = confirm("Xác nhận update!");
        if (r !== true) {
          return
        }
        var select = document.querySelectorAll('tr[id="' + id + '"] > td')

        var person = {
          email: select[1].childNodes[0].value,
          password: select[2].childNodes[0].value,
          emailrecovery: select[3].childNodes[0].value,
          status: select[4].childNodes[0].value,
        }
        $.ajax({
          url: "/mailedit/" + id,
          type: "post",
          dataType: "json",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          data: JSON.stringify(person),
          contentType: 'application/json',
          success: function (result) {

            // const obj = JSON.parse(result);
            var msg = result.mess;

            if (msg == "success") {
              // $('#status').html(msg)
              toastr.success("Cập nhật thành công");
              // window.location.href = "/keymanager.html";
              // var date = new Date("Februari 10, 2020");
              // var dateString = date.toGMTString();
              // var cookieString = result.split('|')[1] + dateString;

              //location.reload();
            } else {
              // $('#status').html(msg)
              toastr.error(msg);
              // $("#status").html(result);
            }
          }
        });
      }

    </script>
    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

{% include 'include/header.html' %}
<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
  }

  * {
    box-sizing: border-box;
  }

  body input {
    border: none;
  }

  body input:focus {
    outline: none;
  }




  /* Set a style for all buttons */
  button {
    background-color: #04AA6D;
    color: white;
    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    cursor: pointer;
    width: 100%;
    opacity: 0.9;
  }

  button:hover {
    opacity: 1;
  }

  /* Float cancel and delete buttons and add an equal width */
  .cancelbtn,
  .deletebtn {
    float: left;
    width: 50%;
  }

  /* Add a color to the cancel button */
  .cancelbtn {
    background-color: #ccc;
    color: black;
  }

  /* Add a color to the delete button */
  .deletebtn {
    background-color: #f44336;
  }

  /* Add padding and center-align text to the container */
  .container {
    padding: 16px;
    text-align: center;
  }

  /* The Modal (background) */
  .modal {
    display: none;
    /* Hidden by default */
    position: fixed;
    /* Stay in place */
    z-index: 1;
    /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    /* Full width */
    height: 100%;
    /* Full height */
    overflow: auto;
    /* Enable scroll if needed */
    background-color: #474e5d;
    padding-top: 50px;
  }

  /* Modal Content/Box */
  .modal-content {
    background-color: #fefefe;
    margin: 5% auto 15% auto;
    /* 5% from the top, 15% from the bottom and centered */
    border: 1px solid #888;
    width: 80%;
    /* Could be more or less, depending on screen size */
  }

  /* Style the horizontal ruler */
  hr {
    border: 1px solid #f1f1f1;
    margin-bottom: 25px;
  }

  /* The Modal Close Button (x) */
  .close {
    position: absolute;
    right: 35px;
    top: 15px;
    font-size: 40px;
    font-weight: bold;
    color: #f1f1f1;
  }

  .close:hover,
  .close:focus {
    color: #f44336;
    cursor: pointer;
  }

  /* Clear floats */
  .clearfix::after {
    content: "";
    clear: both;
    display: table;
  }

  /* Change styles for cancel button and delete button on extra small screens */
  @media screen and (max-width: 300px) {

    .cancelbtn,
    .deletebtn {
      width: 100%;
    }
  }

  .display_heading {
    display: flex;
    justify-content: space-between;
  }

  ._1MmTVs {
    padding: 12px 0;
    margin: 5px 0;
    display: flex;
    align-items: center;
    box-shadow: 0 1px 1px 0 rgb(0 0 0 / 5%);
    color: #212121;
    background: #eaeaea;
    /* border-radius: 10px 10px 0 10px; */
    border-radius: 10px;
  }

  .imagePrd {
    border: 1px solid lightgray;
    margin-left: 5px;
    margin-right: 10px;
  }

  ._1MmTVs>input {
    flex: 1;
    font-size: 14px;
    line-height: 16px;
    border: 0;
    outline: none;
    background-color: inherit;
  }

  ._1MmTVs>svg {
    margin: 0 15px;
    stroke: #bbb;
  }
</style>

<body>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->
  {% include 'include/headersidebar.html' %}

  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title"></h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">

          <div class="yoo-card yoo-style1">

            <div class="yoo-card-heading">
              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Danh sách thiết bị<label class="yoo-card-title" id="countmail"></label>
                </h2>
              </div>
              <div class="ipn_search" style="width: 50%;">
                <div class="_1MmTVs"><svg width="19px" height="19px" viewBox="0 0 19 19">
                    <g id="Search-New" stroke-width="1" fill="none" fill-rule="evenodd">
                      <g id="my-purchase-copy-27" transform="translate(-399.000000, -221.000000)" stroke-width="2">
                        <g id="Group-32" transform="translate(400.000000, 222.000000)">
                          <circle id="Oval-27" cx="7" cy="7" r="7"></circle>
                          <path d="M12,12 L16.9799555,16.919354" id="Path-184" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                        </g>
                      </g>
                    </g>
                  </svg><input autocomplete="off" placeholder="Tìm kiếm" id="ipn_search" value="">
                </div>
              </div>
            </div>


            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th scope="col" width="2%">#</th>
                      <th scope="col" width="10%">device</th>
                      <th scope="col" width="15%">proxy</th>
                      <th scope="col" width="15%">firstmail</th>
                      <th scope="col" width="15%">namemail</th>
                      <th scope="col" width="10%">time</th>
                      <th scope="col" width="15%">#</th>
                    </tr>
                  </thead>
                  <tbody id="files"></tbody>
                </table>

                <div id="page" style="display:flex ; justify-content: center;"></div>


              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <div id="id01" class="modal">
        <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">×</span>
        <form class="modal-content" action="/action_page.php">
          <div class="container">
            <h1>Delete Account</h1>
            <p>Are you sure you want to delete your account?</p>

            <div class="clearfix">
              <button type="button" onclick="document.getElementById('id01').style.display='none'"
                class="cancelbtn">Cancel</button>
              <button type="button" onclick="document.getElementById('id01').style.display='none'"
                class="deletebtn">Delete</button>
            </div>
          </div>
        </form>
      </div>
      {% include 'include/footer.html' %}
      <!-- .yoo-card -->

    </div>
    <!-- .yoo-content -->
    <script>
      document.querySelector(".yoo-uikits-title").textContent = "Danh sách thiết bị";
      // Get the modal
      var modal = document.getElementById('id01');

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      }

      122

      $(document).ready(function () {
        $('#ipn_search').keypress(function (e) {
          if (e.keyCode == 13) {
            Search();
          }
        });
        $('.hwid').keypress(function (e) {
          if (e.keyCode == 13) {
            console.log("1234")
          }
        });
      });
      var search = window.location.search;
      var pages = Regex(search, /page=(\d+)/)
      if (pages != null && pages.length > 1) {
        GetFile(pages[1])
      } else {
        GetFile("1")
      }
      function Search() {
        var search = $("#ipn_search").val()
        if (search == "") {
          GetFile("1")
          return
        }
        $.ajax({
          url: "/devicesearch/" + search,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var max = obj.max;
            var count = obj.count
            var pagedu = count % max
            if (pagedu != 0) {
              pagedu = 1
            }
            var countpage = count / max + pagedu
            var result = obj.result;
            var stringToRender = ""
            var paginations = `<ul class="pagination pagination-lg">`

            var pageshow = pagination(page, countpage)


            for (let i = 0; i < pageshow.length; i++) {
              var pageht = pageshow[i]
              if (pageht == page || pageht == "...") {
                paginations = paginations +
                  `<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1">${pageht}</a></li>`
              } else {
                paginations = paginations +
                  `<li class="page-item"><a class="page-link" href="${window.location.pathname}?page=${pageht}">${pageht}</a></li>`
              }
            }
            paginations = paginations + `</ul>`

            for (let i = 0; i < result.length; i++) {
              const onePost = result[i];
              // console.log(onePost)
              stringToRender +=
                `<tr id="${onePost.id}"><td>${i + 1}</td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.device}"></td><td style="width:10%;"><input onkeypress='UpdateEnter(event, "${onePost.id}");' type="text" style="width:100%;" value="${onePost.proxy}"></td><td><input type="text" style="width:100%;" value="${onePost.firstmail}"></td><td><input type="text" style="width:100%;" value="${onePost.namemail}"></td><td><input type="text" value="${onePost.time}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
            }

            $("#files").html(stringToRender);
            $("#page").html(paginations);

          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }
      function GetFile(page) {
        $.ajax({
          url: "/loaddevice/" + page,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var max = obj.max;
            var count = obj.count
            var pagedu = count % max
            if (pagedu != 0) {
              pagedu = 1
            }
            var countpage = count / max + pagedu
            var result = obj.result;
            var stringToRender = ""
            var paginations = `<ul class="pagination pagination-lg">`

            var pageshow = pagination(page, countpage)


            for (let i = 0; i < pageshow.length; i++) {
              var pageht = pageshow[i]
              if (pageht == page || pageht == "...") {
                paginations = paginations +
                  `<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1">${pageht}</a></li>`
              } else {
                paginations = paginations +
                  `<li class="page-item"><a class="page-link" href="${window.location.pathname}?page=${pageht}">${pageht}</a></li>`
              }
            }
            paginations = paginations + `</ul>`

            for (let i = 0; i < result.length; i++) {
              const onePost = result[i];
              //  console.log(onePost)
              stringToRender +=
                `<tr id="${onePost.id}"><td>${i + 1}</td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.device}"></td><td style="width:10%;"><input onkeypress='UpdateEnter(event, "${onePost.id}");' type="text" style="width:100%;" value="${onePost.proxy}"></td><td><input type="text" style="width:100%;" value="${onePost.firstmail}"></td><td><input type="text" style="width:100%;" value="${onePost.namemail}"></td><td><input type="text" value="${onePost.time}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
            }

            $("#files").html(stringToRender);
            $("#page").html(paginations);
            $("#countmail").html("<b>(" + count + ")</b>");
            $('input[value="undefined"]').val("");

          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }

      function Del(id) {
        var r = confirm("Xác nhận xóa!");
        if (r !== true) {
          return
        }
        $.ajax({
          url: "/devicedelete/" + id,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var result = obj.mess;
            if (result == "success") {
              toastr.success("Xóa thành công");
              location.reload();
            } else {
              toastr.error(result);
            }
          }
        });
      }
      function UpdateEnter(e, id) {
        if (e.keyCode == 13) {
          Update(id)
          return
        }
      }
      function Update(id) {
        var r = confirm("Xác nhận cập nhật!");
        if (r !== true) {
          return
        }
        var select = document.querySelectorAll('tr[id="' + id + '"] > td')

        var person = {
          device: select[1].childNodes[0].value,
          proxy: select[2].childNodes[0].value,
          firstmail: select[3].childNodes[0].value,
          namemail: select[4].childNodes[0].value,
        }
        $.ajax({
          url: "/deviceedit/" + id,
          type: "post",
          dataType: "json",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          data: JSON.stringify(person),
          contentType: 'application/json',
          success: function (result) {

            // const obj = JSON.parse(result);
            var msg = result.mess;

            if (msg == "success") {
              // $('#status').html(msg)
              toastr.success("Cập nhật thành công");
              // window.location.href = "/keymanager.html";
              // var date = new Date("Februari 10, 2020");
              // var dateString = date.toGMTString();
              // var cookieString = result.split('|')[1] + dateString;

              //location.reload();
            } else {
              // $('#status').html(msg)
              toastr.error(msg);
              // $("#status").html(result);
            }
          }
        });
      }

    </script>
    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

{% include 'include/header.html' %}
<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
  }

  * {
    box-sizing: border-box;
  }

  body input {
    border: none;
  }

  body input:focus {
    outline: none;
  }




  /* Set a style for all buttons */
  button {
    background-color: #04AA6D;
    color: white;
    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    cursor: pointer;
    width: 100%;
    opacity: 0.9;
  }

  button:hover {
    opacity: 1;
  }

  /* Float cancel and delete buttons and add an equal width */
  .cancelbtn,
  .deletebtn {
    float: left;
    width: 50%;
  }

  /* Add a color to the cancel button */
  .cancelbtn {
    background-color: #ccc;
    color: black;
  }

  /* Add a color to the delete button */
  .deletebtn {
    background-color: #f44336;
  }

  /* Add padding and center-align text to the container */
  .container {
    padding: 16px;
    text-align: center;
  }

  /* The Modal (background) */
  .modal {
    display: none;
    /* Hidden by default */
    position: fixed;
    /* Stay in place */
    z-index: 1;
    /* Sit on top */
    left: 0;
    top: 0;
    width: 100%;
    /* Full width */
    height: 100%;
    /* Full height */
    overflow: auto;
    /* Enable scroll if needed */
    background-color: #474e5d;
    padding-top: 50px;
  }

  /* Modal Content/Box */
  .modal-content {
    background-color: #fefefe;
    margin: 5% auto 15% auto;
    /* 5% from the top, 15% from the bottom and centered */
    border: 1px solid #888;
    width: 80%;
    /* Could be more or less, depending on screen size */
  }

  /* Style the horizontal ruler */
  hr {
    border: 1px solid #f1f1f1;
    margin-bottom: 25px;
  }

  /* The Modal Close Button (x) */
  .close {
    position: absolute;
    right: 35px;
    top: 15px;
    font-size: 40px;
    font-weight: bold;
    color: #f1f1f1;
  }

  .close:hover,
  .close:focus {
    color: #f44336;
    cursor: pointer;
  }

  /* Clear floats */
  .clearfix::after {
    content: "";
    clear: both;
    display: table;
  }

  /* Change styles for cancel button and delete button on extra small screens */
  @media screen and (max-width: 300px) {

    .cancelbtn,
    .deletebtn {
      width: 100%;
    }
  }

  .display_heading {
    display: flex;
    justify-content: space-between;
  }

  ._1MmTVs {
    padding: 12px 0;
    margin: 5px 0;
    display: flex;
    align-items: center;
    box-shadow: 0 1px 1px 0 rgb(0 0 0 / 5%);
    color: #212121;
    background: #eaeaea;
    /* border-radius: 10px 10px 0 10px; */
    border-radius: 10px;
  }

  .imagePrd {
    border: 1px solid lightgray;
    margin-left: 5px;
    margin-right: 10px;
  }

  ._1MmTVs>input {
    flex: 1;
    font-size: 14px;
    line-height: 16px;
    border: 0;
    outline: none;
    background-color: inherit;
  }

  ._1MmTVs>svg {
    margin: 0 15px;
    stroke: #bbb;
  }

  .groups {
    display: flex;
    flex-direction: row;
    margin-top: 20px;


  }

  label {
    color: black;
  }




  .groups>.lbcountry>select {
    /* margin: 0 10px 0 10px;
    width: 144px; */

    width: 196px;
    background-color: #f0f0f0;


    height: calc(1.5em + 0.75rem + 2px);
    padding: 0.375rem 0.75rem;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.5;
    color: #495057;

    background-clip: padding-box;
    border: 1px solid #ced4da;
    border-radius: 0.25rem;
    transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;

    word-wrap: normal;
    text-transform: none;
    border-color: #f0f0f0;
    max-height: 100px;
  }


  .groups>.lbcountry>label {
    font-size: 16px;
    padding-right: 5px;
  }
</style>

<body>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->
  {% include 'include/headersidebar.html' %}


  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title">Danh sách mail <span>&#10159;</span> <label id="countmail">0</label></h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">

          <div class="yoo-card yoo-style1">

            <div class="yoo-card-heading">
              <div class="groups">
                <div class="lbcountry"><label>Thư mục:</label>
                  <select id="groups">

                  </select>
                </div>
              </div>


              <div class="col-md-12"
                style="display:flex ; justify-content:space-between ; margin-top : 20px ; padding:0 ; ">

                <div class="form-group" style="width : 33% ;margin-bottom:8px!important;">
                  <div class="yoo-select">
                    <select id="combongaytaomail" class="form-control">

                    </select>
                  </div>
                </div>
                <div class="form-group" style="width : 33% ;margin-bottom:8px!important;">
                  <div class=" yoo-select">
                    <select id="combostatus" class="form-control">
                    </select>
                  </div>
                </div>
                <div class="form-group" style="width : 33% ;margin-bottom:8px !important;">
                  <div class="yoo-select">
                    <select id="combodevice" class="form-control">
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-md-3_btn" style="display:flex ; justify-content:space-between ; width: 100%;">
                <div class="btn_load-mail" style="width : 33%">
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-lg"
                    onclick="loadMail(1)">Load mail</button>
                </div>
                <div class="btn_export-mail" style="width : 33%; margin-left:20px">
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-lg"
                    onclick="xuatMail(event)">Xuất</button>
                </div>
                <div class="btn_export-mail" style="width : 33%; margin-left:20px">
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-lg"
                    onclick="updateStatus(event)">Update Status</button>
                </div>
              </div>


              <div class="ipn_search" style="width: 100%;">
                <div class="_1MmTVs"><svg width="19px" height="19px" viewBox="0 0 19 19">
                    <g id="Search-New" stroke-width="1" fill="none" fill-rule="evenodd">
                      <g id="my-purchase-copy-27" transform="translate(-399.000000, -221.000000)" stroke-width="2">
                        <g id="Group-32" transform="translate(400.000000, 222.000000)">
                          <circle id="Oval-27" cx="7" cy="7" r="7"></circle>
                          <path d="M12,12 L16.9799555,16.919354" id="Path-184" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                        </g>
                      </g>
                    </g>
                  </svg><input autocomplete="off" placeholder="Tìm kiếm" id="ipn_search" value="">
                </div>
              </div>
              <b><span class="" id="liveverify" style="color:blue; margin-top : 20px ; padding:0 ;"></span></b>


            </div>
            <!-- <div class="col-md-2">

              </div>
              <div class="col-md-2">

              </div> -->




            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20" style="
              font-size: 14px;">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th scope="col" width="2%">#</th>
                      <th scope="col" width="5%">email</th>
                      <th scope="col" width="5%">password</th>
                      <th scope="col" width="5%">emailrecovery</th>
                      <th scope="col" width="5%">status</th>
                      <th scope="col" width="5%">youtube</th>
                      <th scope="col" width="5%">birthday</th>
                      <th scope="col" width="5%">phonerecovery</th>
                      <th scope="col" width="5%">country</th>
                      <th scope="col" width="5%">googleadw</th>
                      <th scope="col" width="5%">googleadsense</th>
                      <th scope="col" width="5%">chplay</th>
                      <th scope="col" width="5%">paymentmethod</th>
                      <th scope="col" width="5%">googlevoice</th>
                      <th scope="col" width="5%">groups</th>
                      <th scope="col" width="5%">datecreate</th>
                      <th scope="col" width="5%">updater</th>
                      <th scope="col" width="5%">proxy</th>
                      <th scope="col" width="5%">proxylist</th>
                      <th scope="col" width="5%">#</th>
                    </tr>
                  </thead>
                  <tbody id="files"></tbody>
                </table>

                <div id="page" style="display:flex ; justify-content: center;"></div>


              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>


      {% include 'include/footer.html' %}
      <!-- .yoo-card -->

    </div>
    <!-- .yoo-content -->
    <script>

      // Get the modal
      var modal = document.getElementById('id01');

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      }



      $(document).ready(function () {
        $('#ipn_search').keypress(function (e) {
          if (e.keyCode == 13) {
            Search(1);
          }
        });
        $('.hwid').keypress(function (e) {
          if (e.keyCode == 13) {
            console.log("1234")
          }
        });
      });
      function Search(page) {
        var search = $("#ipn_search").val()
        if (search == "") {
          loadMail("1")
          return
        }
        $.ajax({
          url: "/mailsearch/" + search + "?page=" + page,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var max = obj.max;
            var count = obj.count
            var pagedu = count % max
            if (pagedu != 0) {
              pagedu = 1
            }
            var countpage = count / max + pagedu
            var result = obj.result;
            var stringToRender = ""
            var paginations = `<ul class="pagination pagination-lg">`

            var pageshow = pagination(page, countpage)


            for (let i = 0; i < pageshow.length; i++) {
              var pageht = pageshow[i]
              if (pageht == page || pageht == "...") {
                paginations = paginations +
                  `<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1">${pageht}</a></li>`
              } else {
                paginations = paginations +
                  // `<li class="page-item"><a class="page-link" href="${window.location.pathname}?page=${pageht}">${pageht}</a></li>`
                  `<li class="page-item"><a class="page-link" style="color:blue" onclick="Search(${pageht})">${pageht}</a></li>`
              }
            }
            // paginations = paginations + `</ul>`

            // for (let i = 0; i < result.length; i++) {
            //   const onePost = result[i];
            //   //  console.log(onePost)
            //   stringToRender +=
            //     `<tr id="${onePost.id}"><td>${i + 1}</td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.email}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.password}"></td><td><input type="text" style="width:100%;" value="${onePost.emailrecovery}"></td><td><input type="text" value="${onePost.status}"></td><td><input type="text" value="${onePost.birthday}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.phonerecovery}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.groups}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.datecreate}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.updater}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxy}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxylist}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
            // }

            // $("#files").html(stringToRender);
            // $("#page").html(paginations);
            // $("#countmail").html("" + count + "");
            // $('input[value="undefined"]').val("");
            paginations = paginations + `</ul>`
            let verify = 0;
            let x = 0;
            for (let i = 0; i < result.length; i++) {
              x = x + 1
              const onePost = result[i];
              if (Contains(onePost.status, "Verify") == true || Contains(onePost.status, "Disable") == true) {
                verify = verify + 1;
              }
              //  console.log(onePost)
              stringToRender +=
                `<tr id="${onePost.id}"><td>${i + 1}</td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.email}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.password}"></td><td><input type="text" style="width:100%;" value="${onePost.emailrecovery}"></td><td><input type="text" value="${onePost.status}"></td><td><input type="text" style="width:100%;" value="${onePost.youtube}"></td><td><input type="text" value="${onePost.birthday}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.phonerecovery}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.country}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.googleadw}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.googleadsense}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.chplay}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.paymentmethod}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.googlevoice}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.groups}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.datecreate}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.updater}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxy}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxylist}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
            }
            let tileveri = Math.ceil(verify / x * 100)
            let tilelive = 100 - tileveri
            $("#files").html(stringToRender);
            $("#page").html(paginations);
            $("#countmail").html("" + count + "");
            $("#liveverify").html("<span>&#9758;	</span>Verify: " + verify + " (" + tileveri + "%) <span>&#10159;</span> Live: " + (x - verify) + " (" + tilelive + "%)");
            $('input[value="undefined"]').val("");
            // $('tr > *:nth-child(7)').hide();
            // $('tr > *:nth-child(8)').hide();
            // $('tr > *:nth-child(10)').hide();
            // $('tr > *:nth-child(13)').hide();

          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }

      function Xuat() {
        var list = document.querySelectorAll("tr")
        var output = ""
        for (let i = 1; i < list.length; i++) {
          var listi = list[i]
          var email = listi.children[1].children[0].value
          var pass = listi.children[2].children[0].value
          var emailrecovery = listi.children[3].children[0].value
          var datecreate = listi.children[8].children[0].value
          output = output + email + "|" + pass + "|" + emailrecovery + "|" + datecreate + "<br>"
        }
        // window.open(output)
        var myWindow = window.open("", "");
        myWindow.document.write(output);
        // downloadFile("mail.txt", output)
        // console.log(output)
      }


      function getDateByGroups() {
        var groups = $("#groups").val()
        $.ajax({
          url: "/getDateByGroups?groups=" + groups,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (result) {
            let resultJson = JSON.parse(result).result;
            let stringToRender =
              "<option>Date create</option>";
            let x = 0;
            for (let i = 0; i < resultJson.length; i++) {
              x = x + 1;
              const onePost = resultJson[i];
              stringToRender += `<option>${onePost}</option>`;
            }
            $("#combongaytaomail").html(stringToRender);
            $("#combodevice").html('<option>Device</option>');
            $("#combostatus").html('<option>Status</option>');
            getInfoByDateGroups();
          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }
      $("#combongaytaomail").on("change", function (e) {
        getInfoByDateGroups();
      });
      $("#groups").on("change", function (e) {
        getDateByGroups();
      });

      getGroups()


      function getGroups() {
        $.ajax({
          url: "/getGroups",
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (result) {
            var resultJson = JSON.parse(result);
            var groups = resultJson.groups
            var stringToRender =
              "<option>Tất cả</option>";
            var x = 0;
            for (let i = 0; i < groups.length; i++) {
              x = x + 1;
              var onePost = groups[i];
              stringToRender += `<option>${onePost}</option>`;
            }
            $("#groups").html(stringToRender);
            getDateByGroups();
          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }

      function getInfoByDateGroups() {
        var groups = $("#groups").val()
        var date = $("#combongaytaomail").val()
        $.ajax({
          url: "/getInfoByDateGroups?date=" + date + "&groups=" + groups,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (result) {
            var resultJson = JSON.parse(result);
            var statuss = resultJson.status
            var stringToRender =
              "<option>Tất cả</option>";
            var x = 0;
            for (let i = 0; i < statuss.length; i++) {
              x = x + 1;
              var onePost = statuss[i];
              if (onePost == "") {
                onePost = "Chưa chạy"
              }
              stringToRender += `<option>${onePost}</option>`;
            }
            $("#combostatus").html(stringToRender);

            var devices = resultJson.device
            stringToRender =
              "<option>Tất cả</option>";
            var x = 0;
            for (let i = 0; i < devices.length; i++) {
              x = x + 1;
              const onePost = devices[i];
              stringToRender += `<option>${onePost}</option>`;
            }
            $("#combodevice").html(stringToRender);

          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }
      var varexport = null;
      function getmailexport(id) {
        $.ajax({
          url: "getmailexport?id=" + id,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          contentType: 'application/json',
          success: function (result) {
            var msg = result.mess;
            if (msg == undefined) {
              msg = ""
            }
            // console.log("111111111" + "_" + msg)
            if (msg != "") {
              toastr.warning(msg);
              if (msg == "Đang download mail...") {
                clearInterval(varexport)
              }
            } else {
              clearInterval(varexport)
              oldstatus = localStorage.getItem("oldstatus")
              combostatus = localStorage.getItem("combostatus")
              results = result.split("\n")
              allloginok = ""
              allchuachay = ""
              allkhac = ""
              allsaipass = ""
              for (let i = 0; i < results.length; i++) {
                mailht = results[i]
                if (combostatus != "Tất cả") {
                  break
                }
                status = mailht.split("|")[oldstatus]
                if (status === "" || status === "Loading...") {
                  allchuachay = allchuachay + mailht + "\n"
                } else if (status === "login ok" || status.startsWith("change")) {
                  allloginok = allloginok + mailht + "\n"
                } else if (status.startsWith("Your password was changed") || status.startsWith("Wrong password. Try again or click Forgot password to reset it.")) {
                  allsaipass = allsaipass + mailht + "\n"
                } else {
                  allkhac = allkhac + mailht + "\n"
                }
              }
              // console.log(results)
              // delmailexport()
              downloadFile(getTime() + "_All.txt", result)
              if (allloginok != "") {
                downloadFile(getTime() + "_Login ok.txt", allloginok)
              }
              if (allchuachay != "") {
                downloadFile(getTime() + "_Chưa chạy.txt", allchuachay)
              }
              if (allkhac != "") {
                downloadFile(getTime() + "_Khác.txt", allkhac)
              }
              if (allsaipass != "") {
                downloadFile(getTime() + "_Sai pass.txt", allsaipass)
              }
              // openDataNewTab(result)
              toastr.success("Download file thành công")
            }
          }
        });
      }
      function delmailexport() {
        $.ajax({
          url: "delmailexport",
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          contentType: 'application/json',
          success: function (result) {
            console.log(result);
          }
        });
      }
      function loadMail(page) {
        var date = $("#combongaytaomail").val()
        var status = $("#combostatus").val()
        var device = $("#combodevice").val()
        var groups = $("#groups").val()
        var search = window.location.search;
        // var page = "1";
        // var pages = Regex(search, /page=(\d+)/)
        // if (pages != null && pages.length > 1) {
        //   page = pages[1]
        // }
        $.ajax({
          url: "/loadMail?page=" + page + "&datecreate=" + date + "&status=" + status + "&device=" + device + "&groups=" + groups,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var max = obj.max;
            var count = obj.count
            var pagedu = count % max
            if (pagedu != 0) {
              pagedu = 1
            }
            var countpage = count / max + pagedu
            var result = obj.result;

            var stringToRender = ""
            var paginations = `<ul class="pagination pagination-lg">`

            var pageshow = pagination(page, countpage)


            for (let i = 0; i < pageshow.length; i++) {
              var pageht = pageshow[i]
              if (pageht == page || pageht == "...") {
                paginations = paginations +
                  `<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1">${pageht}</a></li>`
              } else {
                paginations = paginations +
                  // `<li class="page-item"><a class="page-link" href="${window.location.pathname}?page=${pageht}">${pageht}</a></li>`
                  `<li class="page-item"><a class="page-link" style="color:blue" onclick="loadMail(${pageht})">${pageht}</a></li>`
              }
            }
            paginations = paginations + `</ul>`
            let verify = 0;
            let x = 0;
            for (let i = 0; i < result.length; i++) {
              x = x + 1
              const onePost = result[i];
              if (Contains(onePost.status, "Verify") == true || Contains(onePost.status, "Disable") == true) {
                verify = verify + 1;
              }
              console.log(onePost)
              stringToRender +=
                `<tr id="${onePost.id}"><td>${i + 1}</td><td><input type="text" style="width:100%;" value="${onePost.email}"></td><td><input type="text" style="width:100%;" value="${onePost.password}"></td><td><input type="text" style="width:100%;" value="${onePost.emailrecovery}"></td><td><input type="text" style="width:100%;" value="${onePost.status}"></td><td><input type="text" style="width:100%;" value="${onePost.youtube}"></td><td><input type="text" value="${onePost.birthday}"></td><td><input type="text" style="width:100%;" value="${onePost.phonerecovery}"></td><td><input type="text" style="width:100%;" value="${onePost.country}"></td><td><input type="text" style="width:100%;" value="${onePost.googleadw}"></td><td><input type="text" style="width:100%;" value="${onePost.googleadsense}"></td><td ><input type="text" style="width:100%;" value="${onePost.chplay}"></td><td><input type="text" style="width:100%;" value="${onePost.paymentmethod}"></td><td><input type="text" style="width:100%;" value="${onePost.googlevoice}"></td><td><input type="text" style="width:100%;" value="${onePost.groups}"></td><td><input type="text" style="width:100%;" value="${onePost.datecreate}"></td><td><input type="text" style="width:100%;" value="${onePost.updater}"></td><td><input type="text" style="width:100%;" value="${onePost.proxy}"></td><td><input type="text" style="width:100%;" value="${onePost.proxylist}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
              // `<tr id="${onePost.id}"><td>${i + 1}</td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.email}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.password}"></td><td><input type="text" style="width:100%;" value="${onePost.emailrecovery}"></td><td><input type="text" value="${onePost.status}"></td><td><input type="text" value="${onePost.youtube}"></td><td><input type="text" value="${onePost.birthday}"></td><td><input type="text" value="${onePost.phonerecovery}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.country}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.googleadw}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.googleadsense}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.chplay}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.paymentmethod}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.googlevoice}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.groups}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.datecreate}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.updater}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxy}"></td><td style="width:10%;"><input type="text" style="width:100%;" value="${onePost.proxylist}"></td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a> | <a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Update("${onePost.id}");'>Update</a></td>`;
            }
            let tileveri = Math.ceil(verify / x * 100)
            let tilelive = 100 - tileveri
            $("#files").html(stringToRender);
            $("#page").html(paginations);
            $("#countmail").html("" + count + "");
            $("#liveverify").html("<span>&#9758;	</span>Verify: " + verify + " (" + tileveri + "%) <span>&#10159;</span> Live: " + (x - verify) + " (" + tilelive + "%)");
            $('input[value="undefined"]').val("");
            $('tr > *:nth-child(7)').hide();
            // $('tr > *:nth-child(8)').hide();
            $('tr > *:nth-child(18)').hide();
            $('tr > *:nth-child(19)').hide();
          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }

      function xuatMail() {
        var oldexport = localStorage.getItem("oldexport")
        if (oldexport == null || oldexport == "") {
          oldexport = 'email,password,emailrecovery,datecreate,status,youtube'
        }
        var columnexport = prompt("Nhập các cột muốn xuất", oldexport);
        if (columnexport == null) {
          toastr.warning("Hủy xuất");
          return
        }
        columnexports = columnexport.split(",")
        oldstatus = -1
        for (let i = 0; i < columnexports.length; i++) {
          console.log(columnexports[i])
          if (columnexports[i] == "status") {
            oldstatus = i
            break
          }
        }
        if (oldstatus == -1) {
          toastr.warning("Hãy nhập thêm cột status vào nơi xuất");
          return
        }
        localStorage.setItem("oldexport", columnexport)
        localStorage.setItem("oldstatus", oldstatus)
        var date = $("#combongaytaomail").val()
        var status = $("#combostatus").val()
        localStorage.setItem("combostatus", status)
        var device = $("#combodevice").val()
        var groups = $("#groups").val()
        var search = window.location.search;
        // var page = "1";
        // var pages = Regex(search, /page=(\d+)/)
        // if (pages != null && pages.length > 1) {
        //   page = pages[1]
        // }
        $.ajax({
          url: "/xuatMail?datecreate=" + date + "&status=" + status + "&device=" + device + "&groups=" + groups + "&columnexport=" + columnexport,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var id = obj.id;
            if (id == undefined) {
              toastr.error(obj.mess);
              return
            }
            varexport = setInterval(() => getmailexport(id), 1000);
          },
          error: function (results) {
            window.location.href = "login.html"
            return
          }
        });
      }
      function updateStatus() {
        var statusupdate = prompt("Nhập status muốn cập nhật", '');
        if (statusupdate == null) {
          toastr.warning("Hủy cập nhật");
          return
        }
        var date = $("#combongaytaomail").val()
        var status = $("#combostatus").val()
        var device = $("#combodevice").val()
        var groups = $("#groups").val()
        $.ajax({
          url: "/updateStatus?datecreate=" + date + "&status=" + status + "&device=" + device + "&groups=" + groups + "&statusupdate=" + statusupdate,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var result = obj.mess;
            if (result == "success") {
              toastr.success("Chạy lại thành công");
              getInfoByDateGroups();
            } else {
              toastr.success(result);
            }
          }
        });
      }
      function Del(id) {
        var r = confirm("Xác nhận xóa!");
        if (r !== true) {
          return
        }
        $.ajax({
          url: "/maildelete/" + id,
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var result = obj.mess;
            if (result == "success") {
              toastr.success("Xóa thành công");
              document.getElementById(id).remove();
            } else {
              toastr.success(result);
            }
          }
        });
      }
      function UpdateEnter(e, id) {
        if (e.keyCode == 13) {
          Update(id)
          return
        }
      }
      function Update(id) {
        var r = confirm("Xác nhận update!");
        if (r !== true) {
          return
        }
        var select = document.querySelectorAll('tr[id="' + id + '"] > td')

        var person = {
          email: select[1].childNodes[0].value,
          password: select[2].childNodes[0].value,
          emailrecovery: select[3].childNodes[0].value,
          status: select[4].childNodes[0].value,
          datecreate: select[9].childNodes[0].value,
        }
        $.ajax({
          url: "/mailedit/" + id,
          type: "post",
          dataType: "json",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          data: JSON.stringify(person),
          contentType: 'application/json',
          success: function (result) {

            // const obj = JSON.parse(result);
            var msg = result.mess;

            if (msg == "success") {
              // $('#status').html(msg)
              toastr.success("Cập nhật thành công");
              // window.location.href = "/keymanager.html";
              // var date = new Date("Februari 10, 2020");
              // var dateString = date.toGMTString();
              // var cookieString = result.split('|')[1] + dateString;

              //location.reload();
            } else {
              // $('#status').html(msg)
              toastr.error(msg);
              // $("#status").html(result);
            }
          }
        });
      }

    </script>
    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

<head>
  <!-- Meta Tags -->
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="YooKits" />
  <!-- Page Title -->
  <title>Login</title>
  <!-- Favicon Icon -->
  <link rel="icon" href="/static/assets/img/favicon.png">
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="/static/assets/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="/static/assets/css/fontawesome.css" />
  <link rel="stylesheet" type="text/css" href="/static/assets/css/iDashboard.css" />
</head>

<body class="yoo-white-bg">
  <div class="yoo-login-wrap yoo-style1">
    <div class="container">
      <div class="row">
        <div class="col-lg-7">
          <div class="yoo-vertical-middle">
            <div class="yoo-vertical-middle-in">
              <div class="yoo-signup-img yoo-style1">
                <img src="/static/assets/img/signup/01.png" alt="">
              </div>
            </div>
          </div>
        </div><!-- .col -->
        <div class="col-lg-5">
          <div class="yoo-vertical-middle">
            <div class="yoo-vertical-middle-in">
              <form class="yoo-form yoo-style1" onsubmit="event.preventDefault()">
                <h2 class="yoo-form-title">Đăng nhập để tiếp tục</h2>
                <div class="yoo-form-subtitle">Chưa có tài khoản? <a href="/signup.html"
                    class="yoo-form-btn yoo-style2">Đăng ký</a></div>
                <div class="yoo-height-b25 yoo-height-lg-b25"></div>
                <!-- <ul class="yoo-social-area yoo-style1 yoo-mp0">
                  <li><a href="#" class="yoo-form-btn yoo-style1 yoo-colo2"><i class="fab fa-facebook-f"></i><span>Sign up with Facebook</span></a></li>
                  <li><a href="#" class="yoo-form-btn yoo-style1 yoo-colo3"><i class="fab fa-google-plus-g"></i><span>Sign up with Gmail</span></a></li>
                </ul>
                <div class="yoo-height-b15 yoo-height-lg-b15"></div>
                <div class="yoo-form-separator">Or</div>
                <div class="yoo-height-b15 yoo-height-lg-b15"></div> -->
                <div class="row">
                  <div class="col-lg-12">
                    <div class="form-group level-up form-group-md">
                      <label for="user">Tài khoản (admin)</label>
                      <input type="text" class="form-control" id="user">
                    </div>
                  </div>
                  <div class="col-lg-12">
                    <div class="form-group level-up form-group-md">
                      <label for="pass">Mật khẩu (admin)</label>
                      <input type="password" class="form-control" id="pass">
                    </div>
                  </div>
                  <div class="col-lg-12">
                    <div class="form-group">
                      <div class="yoo-forget-pass-wrap">
                        <div class="custom-control custom-checkbox">
                          <input class="custom-control-input" type="checkbox" id="gridCheck">
                          <label class="custom-control-label" for="gridCheck">
                            <span class="custom-control-shadow"></span>Lưu tài khoản
                          </label>
                        </div>
                        <a href="#" class="yoo-form-btn yoo-style2">Quên mật khẩu?</a>
                      </div>
                    </div>
                    <button onclick="Login(event)" class="yoo-form-btn yoo-style1 yoo-color1"
                      class="yoo-form-btn yoo-style2 yoo-type1"><span>Đăng nhập</span></button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div><!-- .container -->
  </div>
  <script>
    window.localStorage.setItem("token", "");
    function Login() {
      var person = {
        username: $("#user").val(),
        password: $("#pass").val()
      }
      $.ajax({
        url: "/login",
        type: "post",
        dataType: "json",
        data: JSON.stringify(person),
        contentType: 'application/json',
        success: function (result) {
          var msg = result.mess;
          if (msg == "success") {
            var token = result.token
            toastr.success("Đăng nhập thành công");
            window.location.href = "/index.html";
            window.localStorage.setItem("token", token);
          } else {
            toastr.error(msg);
          }
        }
      });
    }

  </script>
  <!-- Required Scripts -->

  <script src="/static/assets/js/jquery-1.12.4.min.js"></script>
  <script src="/static/assets/js/bootstrap.bundle.min.js"></script>
  <script src="/static/assets/js/smooth-scrollbar.js"></script>
  <script src="/static/assets/js/iDashboard.js"></script>
  <script src="https://unpkg.com/ionicons@5.0.0/dist/ionicons.js"></script>
  <link href="/static/toast/toastr.css" rel="stylesheet" />
  <script src="/static/toast/toastr.min.js"></script>

  <script src="/static/myscript.js"></script>
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

{% include 'include/header.html' %}

<script src="/assets/editor/editor.js"></script>



<link href="/assets/editor/editor.css" type="text/css" rel="stylesheet" />

<body>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->

  {% include 'include/headersidebar.html' %}
  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title"></h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="yoo-card yoo-style1">
            <div class="yoo-card-heading">
              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Xóa mail</h2>
              </div>
              <div class="yoo-card-heading-right btn-toolbar pull-right">
                <div class="row">
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-secondary btn-sm"
                    style="margin: 0px 2px 0px 0px;" onclick="$('#input').val('');">Del</button>
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-sm" id="copy"
                    onclick="CopyTextareaToClipboard('input')">Copy</button>
                </div>
              </div>
            </div>
            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <form>
                  <div class="form-group level-up">
                    <label for="exampleFormControlTextarea1"></label>
                    <textarea class="form-control" style="max-height: none;" id="input" rows="15"
                      placeholder="Nhập mỗi email 1 dòng. Định dạng: email|pass|emailkp|sdtkp"></textarea>
                  </div>

                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-lg"
                    onclick="Xoa(event)">Xóa</button>
                  <br>
                  <br>
                </form>
                <div class="yoo-height-b5 yoo-height-lg-b5"></div>
              </div>
            </div>



          </div>
        </div>

      </div>
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->
      {% include 'include/footer.html' %}

    </div>
    <!-- .yoo-content -->
    <script>




      function Xoa() {
        var person = {
          listmail: $('#input').val(),
          groups: "",
        }
        $.ajax({
          url: "deletemail",
          type: "post",
          dataType: "json",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          data: JSON.stringify(person),
          contentType: 'application/json',
          success: function (result) {


            var msg = result.mess;

            if (msg == "success") {
              toastr.success("Xóa thành công");


            } else {
              toastr.error(msg);

            }

          }
        });
      }

    </script>

    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

{% include 'include/header.html' %}

<body>
  <style>
    .form-control {
      width: unset;
    }
  </style>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->

  {% include 'include/headersidebar.html' %}
  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title"></h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="yoo-card yoo-style1">
            <div class="yoo-card-heading">
              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Danh sách mail (<div id="total" style="color: red;"></div>)
                </h2>
              </div>
              <div class="yoo-card-heading-right btn-toolbar pull-right">
                <div class="row">
                  <input type="text" id="txtmailsearch" class="form-control" placeholder="Nhập mail cần tìm">
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-sm" id="copy"
                    onclick="Search()">Tìm kiếm</button>
                </div>
              </div>
            </div>
            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">Email</th>
                      <th scope="col">Pass</th>
                      <th scope="col">EmailKP</th>
                      <th scope="col">#</th>
                    </tr>
                  </thead>
                  <tbody id="tbody"></tbody>
                </table>

                <div id="page"></div>

              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->

      {% include 'include/footer.html' %}
    </div>
    <!-- .yoo-content -->
    <script>

      $("#txtmailsearch").keyup(function (event) {
        if (event.keyCode == 13) {
          Search();
        }
      });

      var search = window.location.search;
      var pages = Regex(search, /page=(\d+)/)
      if (pages != null && pages.length > 1) {
        GetFile(pages[1])
      } else {
        GetFile("1")
      }
      function GetFile(page) {
        $.ajax({
          url: "/mail/manager/" + page,
          type: "get",
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var count = obj.count
            var result = obj.result;
            var total = obj.total;
            var skip = obj.skip;
            var stringToRender = ""
            var paginations = `<ul class="pagination pagination-lg">`

            var pageshow = pagination(page, count)


            for (let i = 0; i < pageshow.length; i++) {
              var pageht = pageshow[i]
              if (pageht == page || pageht == "...") {
                paginations = paginations + `<li class="page-item disabled"><a class="page-link" href="#" tabindex="-1">${pageht}</a></li>`
              } else {
                paginations = paginations + `<li class="page-item"><a class="page-link" href="/mailmanager.html?page=${pageht}">${pageht}</a></li>`
              }
            }
            paginations = paginations + `</ul>`

            for (let i = 0; i < result.length; i++) {
              const onePost = result[i];
              //  console.log(onePost)
              stringToRender += `<tr id="${onePost.id}"><td>${skip + i + 1}</td><td>${onePost.email}</td><td>${onePost.pass}</td><td>${onePost.emailkp}</td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a></td>`;
            }

            $("#total").html(total);
            $("#tbody").html(stringToRender);
            $("#page").html(paginations);
          }
        });
      }
      function Search() {
        var mailsearch = $('#txtmailsearch').val();
        if (mailsearch == "") {
          if (pages != null && pages.length > 1) {
            GetFile(pages[1])
          } else {
            GetFile("1")
          }
          return
        }
        $("#tbody").html("");
        $("#page").html("<b>Đang tìm kiếm...</b></br></br>");
        $.ajax({
          url: "/mail/search",
          type: "post",
          dataType: "text",
          data: {
            mailsearch: mailsearch,
          },
          success: function (results) {
            const obj = JSON.parse(results);
            var result = obj.result;
            var stringToRender = ""
            if (result == null) {
              $("#page").html("<b>Không tìm thấy kết quả nào</b></br></br>");
              return
            }

            for (let i = 0; i < result.length; i++) {
              const onePost = result[i];
              //  console.log(onePost)
              stringToRender += `<tr id="${onePost.id}"><td>${i + 1}</td><td>${onePost.email}</td><td>${onePost.pass}</td><td>${onePost.emailkp}</td><td><a nohref style='cursor:pointer;color:blue;text-decoration:underline' onClick='Del("${onePost.id}");'>Xóa</a></td>`;
            }
            $("#tbody").html(stringToRender);
            $("#page").html("");
          }
        });
      }
      function Del(id) {
        var r = confirm("Xác nhận xóa!");
        if (r !== true) {
          return
        }
        $.ajax({
          url: "/mail/delete/" + id,
          type: "get",
          dataType: "text",
          success: function (results) {
            const obj = JSON.parse(results);
            var result = obj.msg;
            if (result == "Success") {
              toastr.success("Xóa thành công");
              location.reload();
            } else {
              toastr.success(result);
            }
          }
        });
      }
    </script>
    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

{% include 'include/header.html' %}

<script src="/assets/editor/editor.js"></script>



<link href="/assets/editor/editor.css" type="text/css" rel="stylesheet" />

<body>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->

  {% include 'include/headersidebar.html' %}
  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title"></h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="yoo-card yoo-style1">
            <div class="yoo-card-heading">
              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Cập nhật mail</h2>
              </div>
              <div class="yoo-card-heading-right btn-toolbar pull-right">
                <div class="row">
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-secondary btn-sm"
                    style="margin: 0px 2px 0px 0px;" onclick="$('#input').val('');">Del</button>
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-sm" id="copy"
                    onclick="CopyTextareaToClipboard('input')">Copy</button>
                </div>
              </div>
            </div>
            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <form>
                  <div class="form-group level-up">
                    <label for="exampleFormControlTextarea1"></label>
                    <textarea class="form-control" style="max-height: none;" id="input" rows="15"
                      placeholder="Nhập mỗi email 1 dòng. Định dạng: email|..."></textarea>
                  </div>
                  <input type="text" id="trangthaimail" class="form-control" placeholder="Nhập status email">
                  <br><button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-lg"
                    onclick="update(event)">Cập nhật</button>
                  <br>
                  <br>
                </form>
                <div class="yoo-height-b5 yoo-height-lg-b5"></div>
              </div>
            </div>



          </div>
        </div>

      </div>
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->
      {% include 'include/footer.html' %}

    </div>
    <!-- .yoo-content -->
    <script>
      var myVar = setInterval(checkuserstatus, 3000);
      function checkuserstatus() {
        $.ajax({
          url: "checkuserstatus?status=update",
          type: "get",
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          contentType: 'application/json',
          success: function (result) {
            var msg = result.mess;
            if (msg != "") {
              toastr.warning("Đang update mail cũ chưa xong..." + msg);
            } else {
              toastr.success("Không còn mail nào đang update!")
              clearInterval(myVar)
            }
          }
        });
      }


      function update() {
        var person = {
          listmail: $('#input').val(),
          status: $('#trangthaimail').val(),
        }
        $.ajax({
          url: "mailupdate",
          type: "post",
          dataType: "json",
          data: JSON.stringify(person),
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          contentType: 'application/json',
          success: function (result) {


            var msg = result.mess;

            if (msg == "success") {
              toastr.success("Update thành công");
              myVar = setInterval(checkuserstatus, 3000);
            } else {
              toastr.error(msg);
            }

          }
        });
      }

    </script>

    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

{% include 'include/header.html' %}

<script src="/assets/editor/editor.js"></script>



<link href="/assets/editor/editor.css" type="text/css" rel="stylesheet" />

<body>
  <div class="yoo-height-b60 yoo-height-lg-b60"></div>
  <div class="yoo-headersidebar-toggle">
    <div class="yoo-button-bar1"></div>
    <div class="yoo-button-bar2"></div>
    <div class="yoo-button-bar3"></div>
  </div>
  <!-- .yoo-headersidebar-toggle -->

  {% include 'include/headersidebar.html' %}
  <div class="yoo-content yoo-style1">
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="yoo-uikits-heading">
        <h2 class="yoo-uikits-title"></h2>
      </div>
    </div>
    <div class="yoo-height-b30 yoo-height-lg-b30"></div>
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-12">
          <div class="yoo-card yoo-style1">
            <div class="yoo-card-heading">
              <div class="yoo-card-heading-left">
                <h2 class="yoo-card-title">Thêm mail</h2>
              </div>
              <div class="yoo-card-heading-right btn-toolbar pull-right">
                <div class="row">
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-secondary btn-sm"
                    style="margin: 0px 2px 0px 0px;" onclick="$('#input').val('');">Del</button>
                  <button type="button" ripple="ripple" ripple-color="#fff" class="btn btn-primary btn-sm" id="copy"
                    onclick="CopyTextareaToClipboard('input')">Copy</button>
                </div>
              </div>
            </div>
            <div class="yoo-card-body">
              <div class="yoo-padd-lr-20">
                <div class="yoo-height-b20 yoo-height-lg-b20"></div>
                <form>
                  <div class="form-group level-up">
                    <label for="exampleFormControlTextarea1"></label>
                    <textarea class="form-control" style="max-height: none;" id="input" rows="15"
                      placeholder="Nhập mỗi email 1 dòng. Định dạng: email|pass|emailkp|sdtkp"></textarea>
                  </div>
                  <input type="text" id="txtlomail" class="form-control"
                    placeholder="Nhập lô mail (bỏ trống nếu không cần)"><br>
                  <input type="checkbox" id="onlyaddemailpassemailrecovery"> Chỉ thêm
                  email|pass|emailrecovery<br><button type="button" ripple="ripple" ripple-color="#fff"
                    class="btn btn-primary btn-lg" onclick="them(event)">Thêm</button>
                  <br>
                  <br>
                </form>
                <div class="yoo-height-b5 yoo-height-lg-b5"></div>
              </div>
            </div>



          </div>
        </div>

      </div>
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->
      <div class="yoo-height-b30 yoo-height-lg-b30"></div>

      <!-- .yoo-card -->
      {% include 'include/footer.html' %}

    </div>
    <!-- .yoo-content -->
    <script>




      function them() {
        var person = {
          listmail: $('#input').val(),
          groups: $('#txtlomail').val(),
          onlyaddemailpassemailrecovery: $('#onlyaddemailpassemailrecovery').is(":checked"),
        }

        $.ajax({
          url: "uploadmail",
          type: "post",
          dataType: "json",
          data: JSON.stringify(person),
          beforeSend: function (request) {
            request.setRequestHeader("Authorization", "Bearer " + window.localStorage.token);
          },
          contentType: 'application/json',
          success: function (result) {
            var msg = result.mess;
            if (msg == "success") {
              toastr.success("Thêm thành công");
            } else {
              toastr.error(msg);

            }
          },
          error: function (result) {
            result = result.responseJSON
            var msg = result.detail;
            if (msg == "Not authenticated") {
              toastr.error("Hãy đăng xuất rồi đăng nhập lại");
            } else {
              toastr.error(result);
            }
          }
        });
      }

    </script>

    <!-- Required Scripts -->
</body>

</html><!DOCTYPE html>
<html class="no-js" lang="en">

<head>
  <!-- Meta Tags -->
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="YooKits" />
  <!-- Page Title -->
  <title>SignUp</title>
  <!-- Favicon Icon -->
  <link rel="icon" href="/static/assets/img/favicon.png">
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="/static/assets/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="/static/assets/css/fontawesome.css" />
  <link rel="stylesheet" type="text/css" href="/static/assets/css/iDashboard.css" />
</head>

<body class="yoo-white-bg">
  <div class="yoo-login-wrap yoo-style1">
    <div class="container">
      <div class="row">
        <div class="col-lg-7">
          <div class="yoo-vertical-middle">
            <div class="yoo-vertical-middle-in">
              <div class="yoo-signup-img yoo-style1">
                <img src="/static/assets/img/signup/01.png" alt="">
              </div>
            </div>
          </div>
        </div><!-- .col -->
        <div class="col-lg-5">
          <div class="yoo-vertical-middle">
            <div class="yoo-vertical-middle-in">
              <form class="yoo-form yoo-style1" onsubmit="event.preventDefault()">
                <h2 class="yoo-form-title">Tạo tài khoản mới</h2>
                <div class="yoo-form-subtitle">Đã có tài khoản? <a href="/login.html"
                    class="yoo-form-btn yoo-style2">Đăng nhập</a></div>
                <div class="yoo-height-b25 yoo-height-lg-b25"></div>
                <!-- <ul class="yoo-social-area yoo-style1 yoo-mp0">
                  <li><a href="#" class="yoo-form-btn yoo-style1 yoo-colo2"><i class="fab fa-facebook-f"></i><span>Sign up with Facebook</span></a></li>
                  <li><a href="#" class="yoo-form-btn yoo-style1 yoo-colo3"><i class="fab fa-google-plus-g"></i><span>Sign up with Gmail</span></a></li>
                </ul>
                <div class="yoo-height-b15 yoo-height-lg-b15"></div>
                <div class="yoo-form-separator">Or</div>
                <div class="yoo-height-b15 yoo-height-lg-b15"></div> -->
                <div class="row">
                  <!-- <div class="col-lg-6">
                    <div class="form-group level-up form-group-md">
                      <label for="first-name">Họ</label>
                      <input type="text" class="form-control" id="first-name">
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="form-group level-up form-group-md">
                      <label for="last-name">Tên</label>
                      <input type="text" class="form-control" id="last-name">
                    </div>
                  </div> -->
                  <div class="col-lg-12">
                    <div class="form-group level-up form-group-md">
                      <label for="user">Tài khoản</label>
                      <input type="text" class="form-control" id="user">
                    </div>
                  </div>
                  <div class="col-lg-12">
                    <div class="form-group level-up form-group-md">
                      <label for="password">Mật khẩu</label>
                      <input type="password" class="form-control" id="pass">
                    </div>
                  </div>
                  <div class="col-lg-12">
                    <!-- <div class="form-group">
                      <div class="yoo-termas">
                        <div class="custom-control custom-checkbox">
                        <input class="custom-control-input" type="checkbox" id="gridCheck">
                        <label class="custom-control-label" for="gridCheck">
                          <span class="custom-control-shadow"></span>I agree to terms and condittions & 
                        </label>
                      </div>
                      <a href="#" class="yoo-form-btn yoo-style2">cookies policy.</a>
                      </div>
                    </div> -->
                    <button onclick="Register(event)" class="yoo-form-btn yoo-style1 yoo-color1"
                      class="yoo-form-btn yoo-style2 yoo-type1"><span>Đăng ký</span></button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div><!-- .container -->
  </div>
  <script>
    function Register() {
      var person = {
        username: $("#user").val(),
        password: $("#pass").val()
      }
      $.ajax({
        url: "/register",
        type: "post",
        dataType: "json",
        data: JSON.stringify(person),
        contentType: 'application/json',
        success: function (result) {
          var msg = result.mess;
          if (msg == "success") {
            window.location.href = "/login.html";
          } else {
            toastr.error(msg);
          }
        }
      });
    }

  </script>
  <!-- Required Scripts -->
  <script src="/static/assets/js/jquery-1.12.4.min.js"></script>
  <script src="/static/assets/js/bootstrap.bundle.min.js"></script>
  <script src="/static/assets/js/smooth-scrollbar.js"></script>
  <script src="/static/assets/js/iDashboard.js"></script>
  <script src="https://unpkg.com/ionicons@5.0.0/dist/ionicons.js"></script>
  <link href="/static/toast/toastr.css" rel="stylesheet" />
  <script src="/static/toast/toastr.min.js"></script>


  <script src="/static/myscript.js"></script>
</body>

</html>